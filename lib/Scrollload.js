!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports["Scrollload.js"]=e():t["Scrollload.js"]=e()}(this,function(){return function(t){function e(i){if(o[i])return o[i].exports;var n=o[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,e),n.l=!0,n.exports}var o={};return e.m=t,e.c=o,e.i=function(t){return t},e.d=function(t,o,i){e.o(t,o)||Object.defineProperty(t,o,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(o,"a",o),o},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=5)}([function(t,e){!function(){var e=function(t){var e,o;t=t||document.querySelector(t),t&&t.addEventListener("touchstart",function(i){e=i.touches[0].pageY,o=t.scrollTop,o<=0&&(t.scrollTop=1),o+t.offsetHeight>=t.scrollHeight&&(t.scrollTop=t.scrollHeight-t.offsetHeight-1)},!1)};"undefined"!=typeof window&&"undefined"==typeof t?window.ScrollFix=e:t.exports=e}()},,function(t,e,o){!function(e,o){t.exports=o()}(this,function(){return function(t){function e(i){if(o[i])return o[i].exports;var n=o[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,e),n.l=!0,n.exports}var o={};return e.m=t,e.c=o,e.i=function(t){return t},e.d=function(t,o,i){e.o(t,o)||Object.defineProperty(t,o,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(o,"a",o),o},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,o){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}(),s=function(){function t(e){if(i(this,t),!e||e===window)return null;if(!(e instanceof HTMLElement))throw new Error("parameter 1 must be a HTMLElement instance!");this.win=e;var o=e.querySelector(".localScrollFix-fixDom");o?this.fixDom=o:this.createFixDom(),this.isArrived=!1,this.update()}return n(t,[{key:"createFixDom",value:function(){this.win.insertAdjacentHTML("beforeend",'<div class="localScrollFix-fixDom" style="margin: 0; padding: 0"></div>'),this.fixDom=this.win.querySelector(".localScrollFix-fixDom")}},{key:"removeFixDom",value:function(){this.win.removeChild(this.fixDom),this.fixDom=null}},{key:"arrived",value:function(){this.isArrived=!0,this.removeFixDom()}},{key:"update",value:function(){if(!this.isArrived){var t=this.computerFixDomPaddingTop();t>=0?this.fixDom.style.paddingTop=t+3+"px":this.arrived()}}},{key:"computerFixDomPaddingTop",value:function(){var t=this.fixDom,e=this.win,o=t.getBoundingClientRect().top,i=e.getBoundingClientRect().bottom,n=window.getComputedStyle(e,null),s=n.paddingBottom,r=n.borderBottomWidth;return i-parseFloat(s)-parseFloat(r)-o}}]),t}();e.default=s,window.LocalScrollFix=s}])})},function(t,e,o){"use strict";var i=function(t,e){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var o=Object(t),i=1;i<arguments.length;i++){var n=arguments[i];if(null!=n)for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(o[s]=n[s])}return o};e.a=i},function(t,e,o){"use strict";e.a=function(t,e,o){var i,n,s,r,l=0;o||(o={});var h=function(){l=o.leading===!1?0:Date.now(),i=null,r=t.apply(n,s),i||(n=s=null)},a=function(){var a=Date.now();l||o.leading!==!1||(l=a);var c=e-(a-l);return n=this,s=arguments,c<=0||c>e?(i&&(clearTimeout(i),i=null),l=a,r=t.apply(n,s),i||(n=s=null)):i||o.trailing===!1||(i=setTimeout(h,c)),r};return a.cancel=function(){clearTimeout(i),l=0,i=n=s=null},a}},function(t,e,o){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(){return!0}function s(t){return'<div style="text-align: center;font-size: 12px;line-height: 50px;">'+t+"</div>"}function r(t,e){"transform"in e&&(e.webkitTransform=e.transform),"transition"in e&&(e.webkitTransition=e.transition),t.forEach(function(t){return t&&o.i(c.a)(t.style,e)})}function l(t,e){t.style.clip="rect("+e+"px 1000px 1000px 0)"}function h(){}Object.defineProperty(e,"__esModule",{value:!0});var a=o(4),c=o(3),u=o(2),f=o.n(u),p=o(0),d=o.n(p),m=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}(),v=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t),this._options=o.i(c.a)({},t.defaults,e);var n=this._options.container||document.querySelector(".scrollload-container");if(this.container=n,!(n instanceof HTMLElement))throw new Error("container must be a HTMLElement instance!");if(this.win=this._options.window,this.isGlobalScroll=this.win===window,this.contentDom=this._options.content||this.container.querySelector(".scrollload-content"),!(this.contentDom instanceof HTMLElement))throw new Error("content must be a HTMLElement instance!");this._options.enableLoadMore&&(this.windowHeight=window.innerHeight,this.isLock=this._options.isInitLock,this.hasMoreData=!0,this.createBottomDom(),this.scrollListener=this.scrollListener.bind(this),this.resizeListener=this.resizeListener.bind(this),this.scrollListenerWrapThrottle=o.i(a.a)(this.scrollListener,50),this.resizeListenerWrapThrottle=o.i(a.a)(this.resizeListener,50),this.attachScrollListener()),this._options.enablePullRefresh&&(this.createTopDom(),this.startPageY=0,this.prePageY=0,this.isMoving=!1,this.isMovingDown=!0,this.isRefreshing=!1,this.enterTouchStart=!1,this.distance=0,this.attachTouchListener()),this.fixLocalScroll(),this._options.initedHandler.call(this,this)}return m(t,[{key:"fixLocalScroll",value:function(){this.win!==window&&n()?(this._options.useLocalScrollFix&&(this.localScrollFix=new f.a(this.win)),this._options.useScrollFix&&new d.a(this.win)):(this._options.useLocalScrollFix=!1,this._options.useScrollFix=!1)}},{key:"createBottomDom",value:function(){this.container.insertAdjacentHTML("beforeend",'<div class="scrollload-bottom">'+this._options.loadingHtml+"</div>"),this.bottomDom=this.container.querySelector(".scrollload-bottom")}},{key:"createTopDom",value:function(){var t=this._options,e=t.notEnoughRefreshPortHtml,o=t.overRefreshPortHtml,i=t.refreshingHtml;this.container.insertAdjacentHTML("afterbegin",'<div class="scrollload-top" style="position: relative;">\n                <div class="scrollload-top-content" style="position: absolute; left: 0; right: 0;">\n                    <div class="scrollload-notEnoughRefreshPort" style="display: block">'+e+'</div>\n                    <div class="scrollload-overRefreshPort" style="display: none">'+o+'</div>\n                    <div class="scrollload-refreshing" style="display: none">'+i+"</div>\n                </div>\n            </div>"),this.topDom=this.container.querySelector(".scrollload-top"),this.topContentDom=this.topDom.querySelector(".scrollload-top-content"),this.topDomHeight=this.topContentDom.clientHeight,this.topDom.style.top="-"+this.topDomHeight+"px",this.topContentDom.style.clip="rect(1000px 1000px 1000px 0)",this.notEnoughRefreshPortDom=this.topContentDom.querySelector(".scrollload-notEnoughRefreshPort"),this.overRefreshPortDom=this.topContentDom.querySelector(".scrollload-overRefreshPort"),this.refreshingDom=this.topContentDom.querySelector(".scrollload-refreshing")}},{key:"showNoMoreDataDom",value:function(){this.bottomDom.innerHTML=this._options.noMoreDataHtml}},{key:"showLoadingDom",value:function(){this.bottomDom.innerHTML=this._options.loadingHtml}},{key:"showExceptionDom",value:function(){this.bottomDom.innerHTML=this._options.exceptionHtml}},{key:"showNotEnoughRefreshPortDom",value:function(){r([this.overRefreshPortDom,this.refreshingDom],{display:"none"}),r([this.notEnoughRefreshPortDom],{display:"block"})}},{key:"showOverRefreshPortDom",value:function(){r([this.notEnoughRefreshPortDom,this.refreshingDom],{display:"none"}),r([this.overRefreshPortDom],{display:"block"})}},{key:"showRefreshingDom",value:function(){r([this.notEnoughRefreshPortDom,this.overRefreshPortDom],{display:"none"}),r([this.refreshingDom],{display:"block"})}},{key:"calMovingDistance",value:function(t,e){this.distance=this._options.calMovingDistance(t,e)}},{key:"isTop",value:function(){return this.isGlobalScroll?window.pageYOffset<=0:this.win.scrollTop<=1}},{key:"refreshComplete",value:function(){r([this.topDom,this.contentDom,this.bottomDom],{transition:"all 300ms",transform:"translate3d(0, 0, 0)"}),r([this.topContentDom],{transition:"all 300ms"}),l(this.topContentDom,this.topDomHeight),this.isRefreshing=!1}},{key:"movingHandler",value:function(){this.isArrivedRefreshPort()&&this.arrivedRefreshPortHandler(),this.isOverRefreshPort()?this.overRefreshPortHandler():this.notEnoughRefreshPortHandler();var t=Math.max(this.distance,0);0===t&&(this.isMoving=!1),r([this.topDom,this.contentDom,this.bottomDom],{transform:"translate3d(0, "+t+"px, 0)"}),l(this.topContentDom,this.topDomHeight-t),this._options.touchMove.call(this,this)}},{key:"isOverRefreshPort",value:function(){return this.distance>=this.topDomHeight}},{key:"triggerPullResfresh",value:function(){this.showRefreshingDom(),this.isRefreshing=!0,this._options.pullRefresh.call(this,this),r([this.topDom,this.contentDom,this.bottomDom],{transition:"all 300ms",transform:"translate3d(0, "+this.topDomHeight+"px, 0)"})}},{key:"overRefreshPortHandler",value:function(){this._options.overRefreshPortHandler.call(this,this)}},{key:"notEnoughRefreshPortHandler",value:function(){this._options.notEnoughRefreshPortHandler.call(this,this)}},{key:"isArrivedRefreshPort",value:function(){var t=this._options.calMovingDistance(this.startPageY,this.prePageY);return this.distance>=this.topDomHeight&&t<this.topDomHeight||this.distance<=this.topDomHeight&&t>this.topDomHeight}},{key:"arrivedRefreshPortHandler",value:function(){this.isMovingDown?this.showOverRefreshPortDom():this.showNotEnoughRefreshPortDom(),this._options.arrivedRefreshPortHandler.call(this,this)}},{key:"touchStart",value:function(t){this.isRefreshing||(0===this.topDomHeight&&(this.topDomHeight=this.topContentDom.clientHeight,this.topDom.style.top="-"+this.topDomHeight+"px"),this.enterTouchStart=!0,this.startPageY=this.prePageY=t.touches[0].pageY,r([this.topDom,this.contentDom,this.bottomDom],{transform:"translate3d(0, 0, 0)",transition:"none"}),r([this.topContentDom],{transition:"none"}),this.showNotEnoughRefreshPortDom(),this._options.touchStart.call(this,this))}},{key:"touchMove",value:function(t){if(this.enterTouchStart){var e=t.touches[0].pageY;this.isMovingDown=e>=this.prePageY,this.isMoving?(this.calMovingDistance(this.startPageY,e),this.movingHandler(),t.preventDefault()):this.isTop()&&this.isMovingDown&&(this.isMoving=!0,t.preventDefault()),this.prePageY=e}}},{key:"touchEnd",value:function(t){this.isMoving&&(this._options.touchEnd.call(this,this),this.isOverRefreshPort()?this.triggerPullResfresh():this.refreshComplete(),this.startPageY=this.prePageY=0,this.isMoving=!1)}},{key:"scrollListener",value:function(){this.isLock||this.isBottom()&&(this.isLock=!0,this._options.loadMore.call(this,this))}},{key:"isBottom",value:function(){var t=this.win,e=this.bottomDom,o=this.windowHeight,i=e.getBoundingClientRect().top,n=void 0;if(this.isGlobalScroll)n=o;else{var s=t.getBoundingClientRect(),r=s.height,l=s.top;n=r,i-=l}return i-n<=this._options.threshold}},{key:"resizeListener",value:function(){this.isGlobalScroll&&(this.windowHeight=window.innerHeight),this.scrollListener()}},{key:"attachScrollListener",value:function(){this.win.addEventListener("scroll",this.scrollListenerWrapThrottle),this.win.addEventListener("resize",this.resizeListenerWrapThrottle),this.scrollListener()}},{key:"detachScrollListener",value:function(){this.win.removeEventListener("scroll",this.scrollListenerWrapThrottle),this.win.removeEventListener("resize",this.resizeListenerWrapThrottle)}},{key:"attachTouchListener",value:function(){var t=this;this.container.addEventListener("touchstart",function(e){t.enterTouchStart=!1,t.touchStart(e)}),this.container.addEventListener("touchmove",function(e){t.touchMove(e)}),this.container.addEventListener("touchend",function(e){t.touchEnd(e)})}},{key:"lock",value:function(){this.isLock=!0}},{key:"unLock",value:function(){this.isLock=!1,this.hasMoreData&&this.scrollListener(),this._options.useLocalScrollFix&&this.localScrollFix.update()}},{key:"noMoreData",value:function(){this.lock(),this.hasMoreData=!1,this.showNoMoreDataDom(),this._options.useLocalScrollFix&&!this.localScrollFix.isArrived&&this.localScrollFix.arrived(),this.detachScrollListener()}},{key:"refreshData",value:function(){this.showLoadingDom(),this.isLock=!1,this.hasMoreData=!0,this._options.useLocalScrollFix&&(this.localScrollFix=new f.a(this.win)),this.attachScrollListener()}},{key:"throwException",value:function(){this.showExceptionDom()}},{key:"solveException",value:function(){this.hasMoreData?(this.showLoadingDom(),this.unLock()):this.showNoMoreDataDom()}},{key:"setOptions",value:function(t){o.i(c.a)(this._options,t)}},{key:"getOptions",value:function(){return o.i(c.a)({},this._options)}}],[{key:"setGlobalOptions",value:function(e){o.i(c.a)(t.defaults,e)}}]),t}();v.defaults={enableLoadMore:!0,isInitLock:!1,threshold:10,window:window,useLocalScrollFix:!1,useScrollFix:!1,loadingHtml:s("加载中..."),noMoreDataHtml:s("没有更多数据了"),exceptionHtml:s("出现异常"),loadMore:h,enablePullRefresh:!1,notEnoughRefreshPortHtml:s("下拉刷新"),overRefreshPortHtml:s("松开刷新"),refreshingHtml:s("正在刷新"),pullRefresh:h,arrivedRefreshPortHandler:h,touchStart:h,touchMove:h,touchEnd:h,overRefreshPortHandler:h,notEnoughRefreshPortHandler:h,calMovingDistance:function(t,e){return(e-t)/3},initedHandler:h},e.default=v,window.Scrollload=v}])});